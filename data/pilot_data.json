[
    {
        "question": "Number of patients of race <ARG-RACE><0>.",
        "query": "SELECT COUNT(DISTINCT pe1.person_id) AS number_of_patients FROM <SCHEMA>.person pe1 JOIN <RACE-TEMPLATE><ARG-RACE><0> ON pe1.race_concept_id=concept_id;",
        "final_query_example": "SELECT COUNT(DISTINCT pe1.person_id) AS number_of_patients FROM cmsdesynpuf23m.person pe1 JOIN  ( SELECT concept_id FROM cmsdesynpuf23m.concept WHERE concept_name='White' AND domain_id='Race' AND standard_concept='S' )  ON pe1.race_concept_id=concept_id;"
    },
    {
        "question": "Count of patients grouped by race.",
        "query": "SELECT race, COUNT(DISTINCT pe1.person_id) AS number_of_patients FROM <SCHEMA>.person pe1 JOIN <RACE-TEMPLATE> ON pe1.race_concept_id=concept_id GROUP BY race;",
        "final_query_example": "SELECT race, COUNT(DISTINCT pe1.person_id) AS number_of_patients FROM cmsdesynpuf23m.person pe1 JOIN  ( SELECT concept_id, concept_name AS race FROM cmsdesynpuf23m.concept WHERE domain_id='Race' )  ON pe1.race_concept_id=concept_id GROUP BY race;"
    },
    {
        "question": "Number of patients grouped by gender and ethnicity.",
        "query": "SELECT gender, ethnicity, COUNT(pe1.person_id) AS number_of_patients FROM <SCHEMA>.person pe1 JOIN <GENDER-TEMPLATE> gen_temp1 ON pe1.gender_concept_id=gen_temp1.concept_id JOIN <ETHNICITY-TEMPLATE> eth_temp1 ON pe1.ethnicity_concept_id=eth_temp1.concept_id GROUP BY gender, ethnicity;",
        "final_query_example": "SELECT gender, ethnicity, COUNT(pe1.person_id) AS number_of_patients FROM cmsdesynpuf23m.person pe1 JOIN  ( SELECT concept_id, concept_name AS gender FROM cmsdesynpuf23m.concept WHERE domain_id='Gender' )  gen_temp1 ON pe1.gender_concept_id=gen_temp1.concept_id JOIN  ( SELECT concept_id, concept_name AS ethnicity FROM cmsdesynpuf23m.concept WHERE domain_id='Ethnicity' )  eth_temp1 ON pe1.ethnicity_concept_id=eth_temp1.concept_id GROUP BY gender, ethnicity;"
    },
    {
        "question": "Number of patients by gender and state.",
        "query": "SELECT gender, loc1.state, COUNT(pe1.person_id) AS number_of_patients FROM <SCHEMA>.person pe1 JOIN <GENDER-TEMPLATE> ON pe1.gender_concept_id=concept_id JOIN <SCHEMA>.location loc1 ON pe1.location_id=loc1.location_id GROUP BY gender, state;",
        "final_query_example": "SELECT gender, loc1.state, COUNT(pe1.person_id) AS number_of_patients FROM cmsdesynpuf23m.person pe1 JOIN  ( SELECT concept_id, concept_name AS gender FROM cmsdesynpuf23m.concept WHERE domain_id='Gender' )  ON pe1.gender_concept_id=concept_id JOIN cmsdesynpuf23m.location loc1 ON pe1.location_id=loc1.location_id GROUP BY gender, state;"
    },
    {
        "question": "Number of patients taking <ARG-DRUG><0>.",
        "query": "SELECT COUNT(DISTINCT dr1.person_id) AS number_of_patients FROM <SCHEMA>.drug_exposure dr1 JOIN <DRUG-TEMPLATE><ARG-DRUG><0> ON dr1.drug_concept_id=concept_id;",
        "final_query_example": "SELECT COUNT(DISTINCT dr1.person_id) AS number_of_patients FROM cmsdesynpuf23m.drug_exposure dr1 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='36567') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON dr1.drug_concept_id=concept_id;"
    },
    {
        "question": "How many people have condition <ARG-CONDITION><0> in the year <ARG-TIMEYEARS><0>?",
        "query": "SELECT COUNT(DISTINCT con1.person_id) AS number_of_patients FROM <SCHEMA>.condition_occurrence con1 JOIN <CONDITION-TEMPLATE><ARG-CONDITION><0> ON con1.condition_concept_id=concept_id WHERE DATE_PART('year', con1.condition_start_date)=<ARG-TIMEYEARS><0>;",
        "final_query_example": "SELECT COUNT(DISTINCT con1.person_id) AS number_of_patients FROM cmsdesynpuf23m.condition_occurrence con1 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='S11.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con1.condition_concept_id=concept_id WHERE DATE_PART('year', con1.condition_start_date)=2009;"
    },
    {
        "question": "How many people have condition <ARG-CONDITION><0> in the state <ARG-STATE><0>?",
        "query": "SELECT COUNT(DISTINCT pe1.person_id) AS number_of_patients FROM <SCHEMA>.person pe1 JOIN <SCHEMA>.condition_occurrence con1 ON pe1.person_id=con1.person_id JOIN <STATEID-TEMPLATE><ARG-STATE><0> loc_temp1 ON pe1.location_id=loc_temp1.location_id JOIN <CONDITION-TEMPLATE><ARG-CONDITION><0> ON con1.condition_concept_id=concept_id;",
        "final_query_example": "SELECT COUNT(DISTINCT pe1.person_id) AS number_of_patients FROM cmsdesynpuf23m.person pe1 JOIN cmsdesynpuf23m.condition_occurrence con1 ON pe1.person_id=con1.person_id JOIN  ( SELECT location_id FROM cmsdesynpuf23m.location WHERE state='CA' )  loc_temp1 ON pe1.location_id=loc_temp1.location_id JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='S11.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con1.condition_concept_id=concept_id;"
    },
    {
        "question": "Counts of patients with condition <ARG-CONDITION><0>, <ARG-CONDITION><1>, <ARG-CONDITION><2> or <ARG-CONDITION><3>.",
        "query": "SELECT COUNT( DISTINCT con1.person_id) FROM (<SCHEMA>.condition_occurrence con1 JOIN (((<CONDITION-TEMPLATE><ARG-CONDITION><0> UNION <CONDITION-TEMPLATE><ARG-CONDITION><1>) UNION <CONDITION-TEMPLATE><ARG-CONDITION><2>) UNION <CONDITION-TEMPLATE><ARG-CONDITION><3>) ON con1.condition_concept_id=concept_id);",
        "final_query_example": "SELECT COUNT( DISTINCT con1.person_id) FROM (cmsdesynpuf23m.condition_occurrence con1 JOIN (((( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='S11.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  UNION ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='G47.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id ) ) UNION ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='G45') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id ) ) UNION ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='G45') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id ) ) ON con1.condition_concept_id=concept_id);"
    },
    {
        "question": "Counts of patients with condition <ARG-CONDITION><0>, <ARG-CONDITION><1>, <ARG-CONDITION><2> and <ARG-CONDITION><3>.",
        "query": "SELECT COUNT( DISTINCT con1.person_id) FROM ((((<SCHEMA>.condition_occurrence con1 JOIN <CONDITION-TEMPLATE><ARG-CONDITION><0> ON con1.condition_concept_id=concept_id) JOIN (<SCHEMA>.condition_occurrence con2 JOIN <CONDITION-TEMPLATE><ARG-CONDITION><1> ON con2.condition_concept_id=concept_id) ON con1.person_id=con2.person_id) JOIN (<SCHEMA>.condition_occurrence con3 JOIN <CONDITION-TEMPLATE><ARG-CONDITION><2> ON con3.condition_concept_id=concept_id) ON con2.person_id=con3.person_id) JOIN (<SCHEMA>.condition_occurrence con4 JOIN <CONDITION-TEMPLATE><ARG-CONDITION><3> ON con4.condition_concept_id=concept_id) ON con3.person_id=con4.person_id);",
        "final_query_example": "SELECT COUNT( DISTINCT con1.person_id) FROM ((((cmsdesynpuf23m.condition_occurrence con1 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='S11.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con1.condition_concept_id=concept_id) JOIN (cmsdesynpuf23m.condition_occurrence con2 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='G47.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con2.condition_concept_id=concept_id) ON con1.person_id=con2.person_id) JOIN (cmsdesynpuf23m.condition_occurrence con3 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='G45') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con3.condition_concept_id=concept_id) ON con2.person_id=con3.person_id) JOIN (cmsdesynpuf23m.condition_occurrence con4 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='G45') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con4.condition_concept_id=concept_id) ON con3.person_id=con4.person_id);"
    },
    {
        "question": "Counts of patients taking drug <ARG-DRUG><0>, <ARG-DRUG><1>, <ARG-DRUG><2> or <ARG-DRUG><3>.",
        "query": "SELECT COUNT( DISTINCT dr1.person_id) FROM (<SCHEMA>.drug_exposure dr1 JOIN (((<DRUG-TEMPLATE><ARG-DRUG><0> UNION <DRUG-TEMPLATE><ARG-DRUG><1>) UNION <DRUG-TEMPLATE><ARG-DRUG><2>) UNION <DRUG-TEMPLATE><ARG-DRUG><3>) ON dr1.drug_concept_id=concept_id);",
        "final_query_example": "SELECT COUNT( DISTINCT dr1.person_id) FROM (cmsdesynpuf23m.drug_exposure dr1 JOIN (((( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='36567') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  UNION ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='1191') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id ) ) UNION ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='1191') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id ) ) UNION ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='1191') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id ) ) ON dr1.drug_concept_id=concept_id);"
    },
    {
        "question": "Counts of patients taking drug <ARG-DRUG><0>, <ARG-DRUG><1>, <ARG-DRUG><2> and <ARG-DRUG><3>.",
        "query": "SELECT COUNT( DISTINCT dr1.person_id) FROM ((((<SCHEMA>.drug_exposure dr1 JOIN <DRUG-TEMPLATE><ARG-DRUG><0> ON dr1.drug_concept_id=concept_id) JOIN (<SCHEMA>.drug_exposure dr2 JOIN <DRUG-TEMPLATE><ARG-DRUG><1> ON dr2.drug_concept_id=concept_id) ON dr1.person_id=dr2.person_id) JOIN (<SCHEMA>.drug_exposure dr3 JOIN <DRUG-TEMPLATE><ARG-DRUG><2> ON drug_concept_id=concept_id) ON dr2.person_id=dr3.person_id) JOIN (<SCHEMA>.drug_exposure dr4 JOIN <DRUG-TEMPLATE><ARG-DRUG><3> ON drug_concept_id=concept_id) ON dr3.person_id=dr4.person_id);",
        "final_query_example": "SELECT COUNT( DISTINCT dr1.person_id) FROM ((((cmsdesynpuf23m.drug_exposure dr1 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='36567') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON dr1.drug_concept_id=concept_id) JOIN (cmsdesynpuf23m.drug_exposure dr2 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='1191') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON dr2.drug_concept_id=concept_id) ON dr1.person_id=dr2.person_id) JOIN (cmsdesynpuf23m.drug_exposure dr3 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='1191') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON drug_concept_id=concept_id) ON dr2.person_id=dr3.person_id) JOIN (cmsdesynpuf23m.drug_exposure dr4 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='1191') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON drug_concept_id=concept_id) ON dr3.person_id=dr4.person_id);"
    },
    {
        "question": "Counts of patients with condition <ARG-CONDITION><0>, <ARG-CONDITION><1>, <ARG-CONDITION><2> and <ARG-CONDITION><3> within <ARG-TIMEDAYS><0> days.",
        "query": "SELECT COUNT( DISTINCT a.person_id ) FROM ((((SELECT person_id, MIN(condition_start_date) AS min_start_date FROM (<SCHEMA>.condition_occurrence con1 JOIN <CONDITION-TEMPLATE><ARG-CONDITION><0> ON con1.condition_concept_id=concept_id) GROUP BY person_id) a JOIN (SELECT person_id, MIN(condition_start_date) AS min_start_date FROM (<SCHEMA>.condition_occurrence con2 JOIN <CONDITION-TEMPLATE><ARG-CONDITION><1> ON con2.condition_concept_id=concept_id) GROUP BY person_id) b ON a.person_id=b.person_id ) JOIN (SELECT person_id, MIN(condition_start_date) AS min_start_date FROM (<SCHEMA>.condition_occurrence con3 JOIN <CONDITION-TEMPLATE><ARG-CONDITION><2> ON con3.condition_concept_id=concept_id) GROUP BY person_id) c ON b.person_id=c.person_id) JOIN (SELECT person_id, MIN(condition_start_date) AS min_start_date FROM (<SCHEMA>.condition_occurrence con4 JOIN <CONDITION-TEMPLATE><ARG-CONDITION><3> ON con4.condition_concept_id=concept_id) GROUP BY person_id) d ON c.person_id=d.person_id) WHERE DATEDIFF(day, GREATEST(a.min_start_date, b.min_start_date, c.min_start_date, d.min_start_date), LEAST(a.min_start_date, b.min_start_date, c.min_start_date, d.min_start_date)) < <ARG-TIMEDAYS><0>;",
        "final_query_example": "SELECT COUNT( DISTINCT a.person_id ) FROM ((((SELECT person_id, MIN(condition_start_date) AS min_start_date FROM (cmsdesynpuf23m.condition_occurrence con1 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='S11.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con1.condition_concept_id=concept_id) GROUP BY person_id) a JOIN (SELECT person_id, MIN(condition_start_date) AS min_start_date FROM (cmsdesynpuf23m.condition_occurrence con2 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='G47.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con2.condition_concept_id=concept_id) GROUP BY person_id) b ON a.person_id=b.person_id ) JOIN (SELECT person_id, MIN(condition_start_date) AS min_start_date FROM (cmsdesynpuf23m.condition_occurrence con3 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='G45') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con3.condition_concept_id=concept_id) GROUP BY person_id) c ON b.person_id=c.person_id) JOIN (SELECT person_id, MIN(condition_start_date) AS min_start_date FROM (cmsdesynpuf23m.condition_occurrence con4 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='G45') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con4.condition_concept_id=concept_id) GROUP BY person_id) d ON c.person_id=d.person_id) WHERE DATEDIFF(day, GREATEST(a.min_start_date, b.min_start_date, c.min_start_date, d.min_start_date), LEAST(a.min_start_date, b.min_start_date, c.min_start_date, d.min_start_date)) < 365;"
    },
    {
        "question": "Counts of patients taking drug <ARG-DRUG><0>, <ARG-DRUG><1>, <ARG-DRUG><2> and <ARG-DRUG><3> within <ARG-TIMEDAYS><0> days.",
        "query": "SELECT COUNT( DISTINCT a.person_id ) FROM ((((SELECT person_id, MIN(drug_exposure_start_date) AS min_start_date FROM (<SCHEMA>.drug_exposure dr1 JOIN <DRUG-TEMPLATE><ARG-DRUG><0> ON dr1.drug_concept_id=concept_id) GROUP BY person_id) a JOIN (SELECT person_id, MIN(drug_exposure_start_date) AS min_start_date FROM (<SCHEMA>.drug_exposure dr2 JOIN <DRUG-TEMPLATE><ARG-DRUG><1> ON dr2.drug_concept_id=concept_id) GROUP BY person_id) b ON a.person_id=b.person_id ) JOIN (SELECT person_id, MIN(drug_exposure_start_date) AS min_start_date FROM (<SCHEMA>.drug_exposure dr3 JOIN <DRUG-TEMPLATE><ARG-DRUG><2> ON dr3.drug_concept_id=concept_id) GROUP BY person_id) c ON b.person_id=c.person_id) JOIN (SELECT person_id, MIN(drug_exposure_start_date) AS min_start_date FROM (<SCHEMA>.drug_exposure dr4 JOIN <DRUG-TEMPLATE><ARG-DRUG><3> ON dr4.drug_concept_id=concept_id) GROUP BY person_id) d ON c.person_id=d.person_id) WHERE DATEDIFF(day, GREATEST(a.min_start_date, b.min_start_date, c.min_start_date, d.min_start_date), LEAST(a.min_start_date, b.min_start_date, c.min_start_date, d.min_start_date)) < <ARG-TIMEDAYS><0>;",
        "final_query_example": "SELECT COUNT( DISTINCT a.person_id ) FROM ((((SELECT person_id, MIN(drug_exposure_start_date) AS min_start_date FROM (cmsdesynpuf23m.drug_exposure dr1 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='36567') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON dr1.drug_concept_id=concept_id) GROUP BY person_id) a JOIN (SELECT person_id, MIN(drug_exposure_start_date) AS min_start_date FROM (cmsdesynpuf23m.drug_exposure dr2 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='1191') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON dr2.drug_concept_id=concept_id) GROUP BY person_id) b ON a.person_id=b.person_id ) JOIN (SELECT person_id, MIN(drug_exposure_start_date) AS min_start_date FROM (cmsdesynpuf23m.drug_exposure dr3 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='1191') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON dr3.drug_concept_id=concept_id) GROUP BY person_id) c ON b.person_id=c.person_id) JOIN (SELECT person_id, MIN(drug_exposure_start_date) AS min_start_date FROM (cmsdesynpuf23m.drug_exposure dr4 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='1191') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON dr4.drug_concept_id=concept_id) GROUP BY person_id) d ON c.person_id=d.person_id) WHERE DATEDIFF(day, GREATEST(a.min_start_date, b.min_start_date, c.min_start_date, d.min_start_date), LEAST(a.min_start_date, b.min_start_date, c.min_start_date, d.min_start_date)) < 365;"
    },
    {
        "question": "counts of patients with condition <ARG-CONDITION><0> in year <ARG-TIMEYEARS><0>.",
        "query": "SELECT COUNT(DISTINCT con1.person_id) AS number_of_patients FROM <SCHEMA>.condition_occurrence con1 JOIN <CONDITION-TEMPLATE><ARG-CONDITION><0> ON con1.condition_concept_id=concept_id WHERE DATE_PART('year', con1.condition_start_date)=<ARG-TIMEYEARS><0>;",
        "final_query_example": "SELECT COUNT(DISTINCT con1.person_id) AS number_of_patients FROM cmsdesynpuf23m.condition_occurrence con1 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='S11.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con1.condition_concept_id=concept_id WHERE DATE_PART('year', con1.condition_start_date)=2009;"
    },
    {
        "question": "How many people were treated by drug <ARG-DRUG><0> after the diagnosis of Condition <ARG-CONDITION><0>?",
        "query": "SELECT COUNT( DISTINCT con1.person_id ) FROM (<SCHEMA>.condition_occurrence con1 JOIN <CONDITION-TEMPLATE><ARG-CONDITION><0> ON con1.condition_concept_id=concept_id) JOIN (<SCHEMA>.drug_exposure dr1 JOIN <DRUG-TEMPLATE><ARG-DRUG><0> ON dr1.drug_concept_id=concept_id) ON con1.person_id = dr1.person_id AND con1.condition_start_date < dr1.drug_exposure_start_date;",
        "final_query_example": "SELECT COUNT( DISTINCT con1.person_id ) FROM (cmsdesynpuf23m.condition_occurrence con1 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='S11.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con1.condition_concept_id=concept_id) JOIN (cmsdesynpuf23m.drug_exposure dr1 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='36567') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON dr1.drug_concept_id=concept_id) ON con1.person_id = dr1.person_id AND con1.condition_start_date < dr1.drug_exposure_start_date;"
    },
    {
        "question": "How many people were treated by drug <ARG-DRUG><0> more than <ARG-TIMEDAYS><0> days after being diagnosed of Condition <ARG-CONDITION><0>?",
        "query": "SELECT COUNT( DISTINCT con1.person_id ) FROM (<SCHEMA>.condition_occurrence con1 JOIN <CONDITION-TEMPLATE><ARG-CONDITION><0> ON con1.condition_concept_id=concept_id) JOIN (<SCHEMA>.drug_exposure dr1 JOIN <DRUG-TEMPLATE><ARG-DRUG><0> ON dr1.drug_concept_id=concept_id) ON con1.person_id = dr1.person_id AND DATEDIFF(day, con1.condition_start_date, dr1.drug_exposure_start_date) > <ARG-TIMEDAYS><0>;",
        "final_query_example": "SELECT COUNT( DISTINCT con1.person_id ) FROM (cmsdesynpuf23m.condition_occurrence con1 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='S11.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con1.condition_concept_id=concept_id) JOIN (cmsdesynpuf23m.drug_exposure dr1 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='36567') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON dr1.drug_concept_id=concept_id) ON con1.person_id = dr1.person_id AND DATEDIFF(day, con1.condition_start_date, dr1.drug_exposure_start_date) > 365;"
    },
    {
        "question": "Counts of patients taking drug <ARG-DRUG><0> or <ARG-DRUG><1>.",
        "query": "SELECT COUNT( DISTINCT dr1.person_id) FROM (<SCHEMA>.drug_exposure dr1 JOIN (<DRUG-TEMPLATE><ARG-DRUG><0> UNION <DRUG-TEMPLATE><ARG-DRUG><1>) ON dr1.drug_concept_id=concept_id);",
        "final_query_example": "SELECT COUNT( DISTINCT dr1.person_id) FROM (cmsdesynpuf23m.drug_exposure dr1 JOIN (( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='36567') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  UNION ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='1191') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id ) ) ON dr1.drug_concept_id=concept_id);"
    },
    {
        "question": "Counts of patients taking drug <ARG-DRUG><0> and <ARG-DRUG><1>.",
        "query": "SELECT COUNT( DISTINCT dr1.person_id) FROM ((<SCHEMA>.drug_exposure dr1 JOIN <DRUG-TEMPLATE><ARG-DRUG><0> ON dr1.drug_concept_id=concept_id) JOIN (<SCHEMA>.drug_exposure dr2 JOIN <DRUG-TEMPLATE><ARG-DRUG><1> ON dr2.drug_concept_id=concept_id) ON dr1.person_id=dr2.person_id);",
        "final_query_example": "SELECT COUNT( DISTINCT dr1.person_id) FROM ((cmsdesynpuf23m.drug_exposure dr1 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='36567') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON dr1.drug_concept_id=concept_id) JOIN (cmsdesynpuf23m.drug_exposure dr2 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='1191') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON dr2.drug_concept_id=concept_id) ON dr1.person_id=dr2.person_id);"
    },
    {
        "question": "Counts of patients with condition <ARG-CONDITION><0> and <ARG-CONDITION><1> within <ARG-TIMEDAYS><0> days.",
        "query": "SELECT COUNT( DISTINCT a.person_id ) FROM ((SELECT person_id, MIN(condition_start_date) AS min_start_date FROM (<SCHEMA>.condition_occurrence con1 JOIN <CONDITION-TEMPLATE><ARG-CONDITION><0> ON con1.condition_concept_id=concept_id) GROUP BY person_id) a JOIN (SELECT person_id, MIN(condition_start_date) AS min_start_date FROM (<SCHEMA>.condition_occurrence con2 JOIN <CONDITION-TEMPLATE><ARG-CONDITION><1> ON con2.condition_concept_id=concept_id) GROUP BY person_id) b ON a.person_id=b.person_id ) WHERE DATEDIFF(day, GREATEST(a.min_start_date, b.min_start_date), LEAST(a.min_start_date, b.min_start_date)) < <ARG-TIMEDAYS><0>;",
        "final_query_example": "SELECT COUNT( DISTINCT a.person_id ) FROM ((SELECT person_id, MIN(condition_start_date) AS min_start_date FROM (cmsdesynpuf23m.condition_occurrence con1 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='S11.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con1.condition_concept_id=concept_id) GROUP BY person_id) a JOIN (SELECT person_id, MIN(condition_start_date) AS min_start_date FROM (cmsdesynpuf23m.condition_occurrence con2 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='G47.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con2.condition_concept_id=concept_id) GROUP BY person_id) b ON a.person_id=b.person_id ) WHERE DATEDIFF(day, GREATEST(a.min_start_date, b.min_start_date), LEAST(a.min_start_date, b.min_start_date)) < 365;"
    },
    {
        "question": "Number of patients in the dataset.",
        "query": "SELECT COUNT(DISTINCT pe1.person_id) FROM <SCHEMA>.person pe1 ;",
        "final_query_example": "SELECT COUNT(DISTINCT pe1.person_id) FROM cmsdesynpuf23m.person pe1 ;"
    },
    {
        "question": "Number of patients born in year <ARG-TIMEYEARS><0>.",
        "query": "SELECT COUNT(DISTINCT pe1.person_id) FROM <SCHEMA>.person pe1 WHERE year_of_birth = <ARG-TIMEYEARS><0> ;",
        "final_query_example": "SELECT COUNT(DISTINCT pe1.person_id) FROM cmsdesynpuf23m.person pe1 WHERE year_of_birth = 2009 ;"
    },
    {
        "question": "Number of patients with residence state location at <ARG-STATE><0>.",
        "query": "SELECT COUNT(DISTINCT pe1.person_id) FROM <SCHEMA>.person pe1 JOIN <STATEID-TEMPLATE><ARG-STATE><0> state_temp1 ON pe1.location_id=state_temp1.location_id ;",
        "final_query_example": "SELECT COUNT(DISTINCT pe1.person_id) FROM cmsdesynpuf23m.person pe1 JOIN  ( SELECT location_id FROM cmsdesynpuf23m.location WHERE state='CA' )  state_temp1 ON pe1.location_id=state_temp1.location_id ;"
    },
    {
        "question": "Number of patients grouped by ethnicity.",
        "query": "SELECT ethnicity, COUNT(DISTINCT pe1.person_id) FROM <SCHEMA>.person pe1 JOIN <ETHNICITY-TEMPLATE> ON pe1.ethnicity_concept_id=concept_id GROUP BY ethnicity ;",
        "final_query_example": "SELECT ethnicity, COUNT(DISTINCT pe1.person_id) FROM cmsdesynpuf23m.person pe1 JOIN  ( SELECT concept_id, concept_name AS ethnicity FROM cmsdesynpuf23m.concept WHERE domain_id='Ethnicity' )  ON pe1.ethnicity_concept_id=concept_id GROUP BY ethnicity ;"
    },
    {
        "question": "Number of patients grouped by residence state location.",
        "query": "SELECT state, COUNT(DISTINCT pe1.person_id) FROM <SCHEMA>.person pe1 JOIN <STATENAME-TEMPLATE> state_temp1 ON pe1.location_id=state_temp1.location_id GROUP BY state ;",
        "final_query_example": "SELECT state, COUNT(DISTINCT pe1.person_id) FROM cmsdesynpuf23m.person pe1 JOIN  ( SELECT location_id, state FROM cmsdesynpuf23m.location )  state_temp1 ON pe1.location_id=state_temp1.location_id GROUP BY state ;"
    },
    {
        "question": "Number of patients grouped by year of birth and gender.",
        "query": "SELECT year_of_birth, gender, COUNT( DISTINCT pe1.person_id) FROM (<SCHEMA>.person pe1 JOIN <GENDER-TEMPLATE> ON pe1.gender_concept_id=concept_id) GROUP BY year_of_birth, gender ;",
        "final_query_example": "SELECT year_of_birth, gender, COUNT( DISTINCT pe1.person_id) FROM (cmsdesynpuf23m.person pe1 JOIN  ( SELECT concept_id, concept_name AS gender FROM cmsdesynpuf23m.concept WHERE domain_id='Gender' )  ON pe1.gender_concept_id=concept_id) GROUP BY year_of_birth, gender ;"
    },
    {
        "question": "Number of patients grouped by race and ethnicity.",
        "query": "SELECT race, ethnicity, COUNT( DISTINCT pe1.person_id) FROM ((<SCHEMA>.person pe1 JOIN <RACE-TEMPLATE> ON pe1.race_concept_id=concept_id) JOIN <ETHNICITY-TEMPLATE> eth_temp1 ON pe1.gender_concept_id=eth_temp1.concept_id ) GROUP BY race, ethnicity ;",
        "final_query_example": "SELECT race, ethnicity, COUNT( DISTINCT pe1.person_id) FROM ((cmsdesynpuf23m.person pe1 JOIN  ( SELECT concept_id, concept_name AS race FROM cmsdesynpuf23m.concept WHERE domain_id='Race' )  ON pe1.race_concept_id=concept_id) JOIN  ( SELECT concept_id, concept_name AS ethnicity FROM cmsdesynpuf23m.concept WHERE domain_id='Ethnicity' )  eth_temp1 ON pe1.gender_concept_id=eth_temp1.concept_id ) GROUP BY race, ethnicity ;"
    },
    {
        "question": "Number of patients grouped by race and residence state location.",
        "query": "SELECT race, state, COUNT( DISTINCT pe1.person_id) FROM ((<SCHEMA>.person pe1 JOIN <RACE-TEMPLATE> ON pe1.race_concept_id=concept_id) JOIN <STATENAME-TEMPLATE> state_temp1 ON pe1.location_id=state_temp1.location_id) GROUP BY race, state ;",
        "final_query_example": "SELECT race, state, COUNT( DISTINCT pe1.person_id) FROM ((cmsdesynpuf23m.person pe1 JOIN  ( SELECT concept_id, concept_name AS race FROM cmsdesynpuf23m.concept WHERE domain_id='Race' )  ON pe1.race_concept_id=concept_id) JOIN  ( SELECT location_id, state FROM cmsdesynpuf23m.location )  state_temp1 ON pe1.location_id=state_temp1.location_id) GROUP BY race, state ;"
    },
    {
        "question": "Number of patients grouped by ethnicity and residence state location.",
        "query": "SELECT ethnicity, state, COUNT( DISTINCT pe1.person_id) FROM ((<SCHEMA>.person pe1 JOIN <ETHNICITY-TEMPLATE> ON pe1.ethnicity_concept_id=concept_id) JOIN <STATENAME-TEMPLATE> state_temp1 ON pe1.location_id=state_temp1.location_id) GROUP BY ethnicity, state ;",
        "final_query_example": "SELECT ethnicity, state, COUNT( DISTINCT pe1.person_id) FROM ((cmsdesynpuf23m.person pe1 JOIN  ( SELECT concept_id, concept_name AS ethnicity FROM cmsdesynpuf23m.concept WHERE domain_id='Ethnicity' )  ON pe1.ethnicity_concept_id=concept_id) JOIN  ( SELECT location_id, state FROM cmsdesynpuf23m.location )  state_temp1 ON pe1.location_id=state_temp1.location_id) GROUP BY ethnicity, state ;"
    },
    {
        "question": "Number of patients with <ARG-CONDITION><O>.",
        "query": "SELECT COUNT( DISTINCT con1.person_id ) FROM (<SCHEMA>.condition_occurrence con1 JOIN <CONDITION-TEMPLATE><ARG-CONDITION><0> ON con1.condition_concept_id=concept_id) ;",
        "final_query_example": "SELECT COUNT( DISTINCT con1.person_id ) FROM (cmsdesynpuf23m.condition_occurrence con1 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='S11.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con1.condition_concept_id=concept_id) ;"
    },
    {
        "question": "Number of <ARG-GENDER><O> patients with <ARG-CONDITION><O>.",
        "query": "SELECT COUNT( DISTINCT pe1.person_id ) FROM ( (<SCHEMA>.person JOIN <GENDER-TEMPLATE><ARG-GENDER><0> ON gender_concept_id=concept_id) pe1 JOIN (<SCHEMA>.condition_occurrence JOIN <CONDITION-TEMPLATE><ARG-CONDITION><0> ON condition_concept_id=concept_id) pe2 ON pe1.person_id=pe2.person_id) ;",
        "final_query_example": "SELECT COUNT( DISTINCT pe1.person_id ) FROM ( (cmsdesynpuf23m.person JOIN  ( SELECT concept_id FROM cmsdesynpuf23m.concept WHERE concept_name='FEMALE' AND domain_id='Gender' AND standard_concept='S' )  ON gender_concept_id=concept_id) pe1 JOIN (cmsdesynpuf23m.condition_occurrence JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='S11.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON condition_concept_id=concept_id) pe2 ON pe1.person_id=pe2.person_id) ;"
    },
    {
        "question": "How many people have condition <ARG-CONDITION><0> in the cohort of race <ARG-RACE><0>?",
        "query": "SELECT COUNT(pe1.person_id) FROM ((<SCHEMA>.person pe1 JOIN <RACE-TEMPLATE><ARG-RACE><0> ON pe1.race_concept_id=concept_id)  JOIN (<SCHEMA>.condition_occurrence con1 JOIN <CONDITION-TEMPLATE><ARG-CONDITION><0> ON condition_concept_id=concept_id) ON pe1.person_id=con1.person_id)",
        "final_query_example": "SELECT COUNT(pe1.person_id) FROM ((cmsdesynpuf23m.person pe1 JOIN  ( SELECT concept_id FROM cmsdesynpuf23m.concept WHERE concept_name='White' AND domain_id='Race' AND standard_concept='S' )  ON pe1.race_concept_id=concept_id)  JOIN (cmsdesynpuf23m.condition_occurrence con1 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='S11.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON condition_concept_id=concept_id) ON pe1.person_id=con1.person_id)"
    },
    {
        "question": "Counts of patients with condition <ARG-CONDITION><0> or <ARG-CONDITION><1>.",
        "query": "SELECT COUNT( DISTINCT person_id) FROM (<SCHEMA>.condition_occurrence JOIN (<CONDITION-TEMPLATE><ARG-CONDITION><0> UNION <CONDITION-TEMPLATE><ARG-CONDITION><1>) ON condition_concept_id=concept_id)",
        "final_query_example": "SELECT COUNT( DISTINCT person_id) FROM (cmsdesynpuf23m.condition_occurrence JOIN (( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='S11.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  UNION ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='G47.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id ) ) ON condition_concept_id=concept_id)"
    },
    {
        "question": "Counts of patients with condition <ARG-CONDITION><0> and <ARG-CONDITION><1>.",
        "query": "SELECT COUNT( DISTINCT pe1.person_id) FROM ( (<SCHEMA>.condition_occurrence JOIN <CONDITION-TEMPLATE><ARG-CONDITION><0> ON condition_concept_id=concept_id) pe1 JOIN (<SCHEMA>.condition_occurrence JOIN <CONDITION-TEMPLATE><ARG-CONDITION><1> ON condition_concept_id=concept_id) pe2 ON pe1.person_id=pe2.person_id)",
        "final_query_example": "SELECT COUNT( DISTINCT pe1.person_id) FROM ( (cmsdesynpuf23m.condition_occurrence JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='S11.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON condition_concept_id=concept_id) pe1 JOIN (cmsdesynpuf23m.condition_occurrence JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='G47.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON condition_concept_id=concept_id) pe2 ON pe1.person_id=pe2.person_id)"
    },
    {
        "question": "Number of patients of specific gender <ARG-GENDER><0>.",
        "query": "SELECT COUNT( DISTINCT pe1.person_id) FROM <SCHEMA>.person pe1 JOIN <GENDER-TEMPLATE><ARG-GENDER><0> ON pe1.gender_concept_id=concept_id;",
        "final_query_example": "SELECT COUNT( DISTINCT pe1.person_id) FROM cmsdesynpuf23m.person pe1 JOIN  ( SELECT concept_id FROM cmsdesynpuf23m.concept WHERE concept_name='FEMALE' AND domain_id='Gender' AND standard_concept='S' )  ON pe1.gender_concept_id=concept_id;"
    },
    {
        "question": "Number of patients of ethnicity <ARG-ETHNICITY><0>.",
        "query": "SELECT COUNT( DISTINCT pe1.person_id) FROM <SCHEMA>.person pe1 JOIN <ETHNICITY-TEMPLATE><ARG-ETHNICITY><0> ON pe1.ethnicity_concept_id=concept_id;",
        "final_query_example": "SELECT COUNT( DISTINCT pe1.person_id) FROM cmsdesynpuf23m.person pe1 JOIN  ( SELECT concept_id FROM cmsdesynpuf23m.concept WHERE concept_name='Not Hispanic or Latino' AND domain_id='Ethnicity' AND standard_concept='S' )  ON pe1.ethnicity_concept_id=concept_id;"
    },
    {
        "question": "Number of patients grouped by gender.",
        "query": "SELECT gender, COUNT( DISTINCT pe1.person_id) FROM (<SCHEMA>.person pe1 JOIN <GENDER-TEMPLATE> ON pe1.gender_concept_id=concept_id) GROUP BY gender;",
        "final_query_example": "SELECT gender, COUNT( DISTINCT pe1.person_id) FROM (cmsdesynpuf23m.person pe1 JOIN  ( SELECT concept_id, concept_name AS gender FROM cmsdesynpuf23m.concept WHERE domain_id='Gender' )  ON pe1.gender_concept_id=concept_id) GROUP BY gender;"
    },
    {
        "question": "Distribution of patients by year of birth.",
        "query": "SELECT year_of_birth, COUNT( DISTINCT pe1.person_id) FROM <SCHEMA>.person pe1 GROUP BY year_of_birth;",
        "final_query_example": "SELECT year_of_birth, COUNT( DISTINCT pe1.person_id) FROM cmsdesynpuf23m.person pe1 GROUP BY year_of_birth;"
    },
    {
        "question": "Number of patients grouped by race and gender.",
        "query": "SELECT race, gender, COUNT( DISTINCT pe1.person_id) FROM ((<SCHEMA>.person pe1 JOIN <RACE-TEMPLATE> ON pe1.race_concept_id=concept_id) JOIN <GENDER-TEMPLATE> gen_temp1 ON pe1.gender_concept_id=gen_temp1.concept_id ) GROUP BY race, gender;",
        "final_query_example": "SELECT race, gender, COUNT( DISTINCT pe1.person_id) FROM ((cmsdesynpuf23m.person pe1 JOIN  ( SELECT concept_id, concept_name AS race FROM cmsdesynpuf23m.concept WHERE domain_id='Race' )  ON pe1.race_concept_id=concept_id) JOIN  ( SELECT concept_id, concept_name AS gender FROM cmsdesynpuf23m.concept WHERE domain_id='Gender' )  gen_temp1 ON pe1.gender_concept_id=gen_temp1.concept_id ) GROUP BY race, gender;"
    },
    {
        "question": "Number of patients grouped by race and year of birth.",
        "query": "SELECT race, year_of_birth, COUNT( DISTINCT pe1.person_id) FROM (<SCHEMA>.person pe1 JOIN <RACE-TEMPLATE> ON pe1.race_concept_id=concept_id) GROUP BY race, year_of_birth;",
        "final_query_example": "SELECT race, year_of_birth, COUNT( DISTINCT pe1.person_id) FROM (cmsdesynpuf23m.person pe1 JOIN  ( SELECT concept_id, concept_name AS race FROM cmsdesynpuf23m.concept WHERE domain_id='Race' )  ON pe1.race_concept_id=concept_id) GROUP BY race, year_of_birth;"
    },
    {
        "question": "Number of patients grouped by ethnicity and year of birth.",
        "query": "SELECT ethnicity, year_of_birth, COUNT( DISTINCT pe1.person_id) FROM (<SCHEMA>.person pe1 JOIN <ETHNICITY-TEMPLATE> ON pe1.ethnicity_concept_id=concept_id) GROUP BY ethnicity, year_of_birth;",
        "final_query_example": "SELECT ethnicity, year_of_birth, COUNT( DISTINCT pe1.person_id) FROM (cmsdesynpuf23m.person pe1 JOIN  ( SELECT concept_id, concept_name AS ethnicity FROM cmsdesynpuf23m.concept WHERE domain_id='Ethnicity' )  ON pe1.ethnicity_concept_id=concept_id) GROUP BY ethnicity, year_of_birth;"
    },
    {
        "question": "Number of patients grouped by year of birth and residence state location.",
        "query": "SELECT year_of_birth, state, COUNT( DISTINCT pe1.person_id) FROM (<SCHEMA>.person pe1 JOIN <STATENAME-TEMPLATE> state_temp1 ON pe1.location_id=state_temp1.location_id) GROUP BY year_of_birth, state;",
        "final_query_example": "SELECT year_of_birth, state, COUNT( DISTINCT pe1.person_id) FROM (cmsdesynpuf23m.person pe1 JOIN  ( SELECT location_id, state FROM cmsdesynpuf23m.location )  state_temp1 ON pe1.location_id=state_temp1.location_id) GROUP BY year_of_birth, state;"
    },
    {
        "question": "Number of patients taking <ARG-DRUG><0>.",
        "query": "SELECT COUNT( DISTINCT pe1.person_id) FROM (<SCHEMA>.person pe1 JOIN (<DRUG-TEMPLATE><ARG-DRUG><0> JOIN <SCHEMA>.drug_exposure dr1 ON concept_id=drug_concept_id) ON pe1.person_id=dr1.person_id);",
        "final_query_example": "SELECT COUNT( DISTINCT pe1.person_id) FROM (cmsdesynpuf23m.person pe1 JOIN (( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='36567') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  JOIN cmsdesynpuf23m.drug_exposure dr1 ON concept_id=drug_concept_id) ON pe1.person_id=dr1.person_id);"
    },
    {
        "question": "How many people have condition <ARG-CONDITION><0> at age <ARG-AGE><0>?",
        "query": "SELECT COUNT( DISTINCT pe1.person_id ) FROM ((<SCHEMA>.person pe1 JOIN <SCHEMA>.condition_occurrence con1 ON pe1.person_id=con1.person_id) JOIN <CONDITION-TEMPLATE><ARG-CONDITION><0> ON con1.condition_concept_id=concept_id) WHERE DATE_PART_YEAR(condition_start_date) - year_of_birth = <ARG-AGE><0> ;",
        "final_query_example": "SELECT COUNT( DISTINCT pe1.person_id ) FROM ((cmsdesynpuf23m.person pe1 JOIN cmsdesynpuf23m.condition_occurrence con1 ON pe1.person_id=con1.person_id) JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='S11.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con1.condition_concept_id=concept_id) WHERE DATE_PART_YEAR(condition_start_date) - year_of_birth = 50 ;"
    },
    {
        "question": "How many people of ethnicity <ARG-ETHNICITY><0> have condition <ARG-CONDITION><0>?",
        "query": "SELECT COUNT( DISTINCT pe1.person_id) FROM ((<SCHEMA>.person pe1 JOIN <ETHNICITY-TEMPLATE><ARG-ETHNICITY><0> ON pe1.ethnicity_concept_id=concept_id) JOIN (<CONDITION-TEMPLATE><ARG-CONDITION><0> JOIN <SCHEMA>.condition_occurrence con1 ON concept_id=con1.condition_concept_id) ON pe1.person_id=con1.person_id);",
        "final_query_example": "SELECT COUNT( DISTINCT pe1.person_id) FROM ((cmsdesynpuf23m.person pe1 JOIN  ( SELECT concept_id FROM cmsdesynpuf23m.concept WHERE concept_name='Not Hispanic or Latino' AND domain_id='Ethnicity' AND standard_concept='S' )  ON pe1.ethnicity_concept_id=concept_id) JOIN (( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='S11.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  JOIN cmsdesynpuf23m.condition_occurrence con1 ON concept_id=con1.condition_concept_id) ON pe1.person_id=con1.person_id);"
    },
    {
        "question": "Counts of patients with condition <ARG-CONDITION><0>, <ARG-CONDITION><1>, or <ARG-CONDITION><2>.",
        "query": "SELECT COUNT( DISTINCT con1.person_id) FROM (<SCHEMA>.condition_occurrence con1 JOIN ((<CONDITION-TEMPLATE><ARG-CONDITION><0> UNION <CONDITION-TEMPLATE><ARG-CONDITION><1>) UNION <CONDITION-TEMPLATE><ARG-CONDITION><2>) ON con1.condition_concept_id=concept_id) ;",
        "final_query_example": "SELECT COUNT( DISTINCT con1.person_id) FROM (cmsdesynpuf23m.condition_occurrence con1 JOIN ((( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='S11.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  UNION ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='G47.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id ) ) UNION ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='G45') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id ) ) ON con1.condition_concept_id=concept_id) ;"
    },
    {
        "question": "Counts of patients with condition <ARG-CONDITION><0>, <ARG-CONDITION><1>, and <ARG-CONDITION><2>.",
        "query": "SELECT COUNT( DISTINCT con1.person_id) FROM ( ((<SCHEMA>.condition_occurrence con1 JOIN <CONDITION-TEMPLATE><ARG-CONDITION><0> ON con1.condition_concept_id=concept_id) JOIN (<SCHEMA>.condition_occurrence con2 JOIN <CONDITION-TEMPLATE><ARG-CONDITION><1> ON con2.condition_concept_id=concept_id) ON con1.person_id=con2.person_id) JOIN (<SCHEMA>.condition_occurrence con3 JOIN <CONDITION-TEMPLATE><ARG-CONDITION><2> ON con3.condition_concept_id=concept_id) ON con2.person_id=con3.person_id);",
        "final_query_example": "SELECT COUNT( DISTINCT con1.person_id) FROM ( ((cmsdesynpuf23m.condition_occurrence con1 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='S11.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con1.condition_concept_id=concept_id) JOIN (cmsdesynpuf23m.condition_occurrence con2 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='G47.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con2.condition_concept_id=concept_id) ON con1.person_id=con2.person_id) JOIN (cmsdesynpuf23m.condition_occurrence con3 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='G45') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con3.condition_concept_id=concept_id) ON con2.person_id=con3.person_id);"
    },
    {
        "question": "Counts of patients taking drug <ARG-DRUG><0>, <ARG-DRUG><1>, or <ARG-DRUG><2>.",
        "query": "SELECT COUNT( DISTINCT dr1.person_id) FROM (<SCHEMA>.drug_exposure dr1 JOIN ((<DRUG-TEMPLATE><ARG-DRUG><0> UNION <DRUG-TEMPLATE><ARG-DRUG><1>) UNION <DRUG-TEMPLATE><ARG-DRUG><2>) ON dr1.drug_concept_id=concept_id) ;",
        "final_query_example": "SELECT COUNT( DISTINCT dr1.person_id) FROM (cmsdesynpuf23m.drug_exposure dr1 JOIN ((( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='36567') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  UNION ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='1191') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id ) ) UNION ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='1191') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id ) ) ON dr1.drug_concept_id=concept_id) ;"
    },
    {
        "question": "Counts of patients taking drug <ARG-DRUG><0>, <ARG-DRUG><1>, and <ARG-DRUG><2>.",
        "query": "SELECT COUNT( DISTINCT dr1.person_id) FROM (((<SCHEMA>.drug_exposure dr1 JOIN <DRUG-TEMPLATE><ARG-DRUG><0> ON dr1.drug_concept_id=concept_id) JOIN (<SCHEMA>.drug_exposure dr2 JOIN <DRUG-TEMPLATE><ARG-DRUG><1> ON dr2.drug_concept_id=concept_id) ON dr1.person_id=dr2.person_id) JOIN (<SCHEMA>.drug_exposure dr3 JOIN <DRUG-TEMPLATE><ARG-DRUG><2> ON drug_concept_id=concept_id) ON dr2.person_id=dr3.person_id);",
        "final_query_example": "SELECT COUNT( DISTINCT dr1.person_id) FROM (((cmsdesynpuf23m.drug_exposure dr1 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='36567') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON dr1.drug_concept_id=concept_id) JOIN (cmsdesynpuf23m.drug_exposure dr2 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='1191') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON dr2.drug_concept_id=concept_id) ON dr1.person_id=dr2.person_id) JOIN (cmsdesynpuf23m.drug_exposure dr3 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='1191') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON drug_concept_id=concept_id) ON dr2.person_id=dr3.person_id);"
    },
    {
        "question": "Counts of patients with condition <ARG-CONDITION><0>, <ARG-CONDITION><1>, and <ARG-CONDITION><2> within <ARG-TIMEDAYS><0> days.",
        "query": "SELECT COUNT( DISTINCT a.person_id ) FROM (((SELECT person_id, MIN(condition_start_date) AS min_start_date FROM (<SCHEMA>.condition_occurrence con1 JOIN <CONDITION-TEMPLATE><ARG-CONDITION><0> ON con1.condition_concept_id=concept_id) GROUP BY person_id) a JOIN (SELECT person_id, MIN(condition_start_date) AS min_start_date FROM (<SCHEMA>.condition_occurrence con2 JOIN <CONDITION-TEMPLATE><ARG-CONDITION><1> ON con2.condition_concept_id=concept_id) GROUP BY person_id) b ON a.person_id=b.person_id ) JOIN (SELECT person_id, MIN(condition_start_date) AS min_start_date FROM (<SCHEMA>.condition_occurrence con3 JOIN <CONDITION-TEMPLATE><ARG-CONDITION><2> ON con3.condition_concept_id=concept_id) GROUP BY person_id) c ON b.person_id=c.person_id) WHERE DATEDIFF(day, GREATEST(a.min_start_date, b.min_start_date, c.min_start_date), LEAST(a.min_start_date, b.min_start_date, c.min_start_date)) < <ARG-TIMEDAYS><0>;",
        "final_query_example": "SELECT COUNT( DISTINCT a.person_id ) FROM (((SELECT person_id, MIN(condition_start_date) AS min_start_date FROM (cmsdesynpuf23m.condition_occurrence con1 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='S11.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con1.condition_concept_id=concept_id) GROUP BY person_id) a JOIN (SELECT person_id, MIN(condition_start_date) AS min_start_date FROM (cmsdesynpuf23m.condition_occurrence con2 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='G47.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con2.condition_concept_id=concept_id) GROUP BY person_id) b ON a.person_id=b.person_id ) JOIN (SELECT person_id, MIN(condition_start_date) AS min_start_date FROM (cmsdesynpuf23m.condition_occurrence con3 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='G45') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con3.condition_concept_id=concept_id) GROUP BY person_id) c ON b.person_id=c.person_id) WHERE (ABS(DATEDIFF(day, b.min_start_date, a.min_start_date)) + ABS(DATEDIFF(day, c.min_start_date, b.min_start_date)) < 365 OR  ABS(DATEDIFF(day, c.min_start_date, a.min_start_date)) + ABS(DATEDIFF(day, b.min_start_date, c.min_start_date)) < 365 OR  ABS(DATEDIFF(day, a.min_start_date, b.min_start_date)) + ABS(DATEDIFF(day, c.min_start_date, a.min_start_date)) < 365 );"
    },
    {
        "question": "Counts of patients taking drug <ARG-DRUG><0>, <ARG-DRUG><1>, and <ARG-DRUG><2> within <ARG-TIMEDAYS><0> days.",
        "query": "SELECT COUNT( DISTINCT a.person_id ) FROM (((SELECT person_id, MIN(drug_exposure_start_date) AS min_start_date FROM (<SCHEMA>.drug_exposure dr1 JOIN <DRUG-TEMPLATE><ARG-DRUG><0> ON dr1.drug_concept_id=concept_id) GROUP BY person_id) a JOIN (SELECT person_id, MIN(drug_exposure_start_date) AS min_start_date FROM (<SCHEMA>.drug_exposure dr2 JOIN <DRUG-TEMPLATE><ARG-DRUG><1> ON dr2.drug_concept_id=concept_id) GROUP BY person_id) b ON a.person_id=b.person_id ) JOIN (SELECT person_id, MIN(drug_exposure_start_date) AS min_start_date FROM (<SCHEMA>.drug_exposure dr3 JOIN <DRUG-TEMPLATE><ARG-DRUG><2> ON dr3.drug_concept_id=concept_id) GROUP BY person_id) c ON b.person_id=c.person_id) WHERE DATEDIFF(day, GREATEST(a.min_start_date, b.min_start_date, c.min_start_date), LEAST(a.min_start_date, b.min_start_date, c.min_start_date)) < <ARG-TIMEDAYS><0>;",
        "final_query_example": "SELECT COUNT( DISTINCT a.person_id ) FROM (((SELECT person_id, MIN(drug_exposure_start_date) AS min_start_date FROM (cmsdesynpuf23m.drug_exposure dr1 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='36567') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON dr1.drug_concept_id=concept_id) GROUP BY person_id) a JOIN (SELECT person_id, MIN(drug_exposure_start_date) AS min_start_date FROM (cmsdesynpuf23m.drug_exposure dr2 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='1191') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON dr2.drug_concept_id=concept_id) GROUP BY person_id) b ON a.person_id=b.person_id ) JOIN (SELECT person_id, MIN(drug_exposure_start_date) AS min_start_date FROM (cmsdesynpuf23m.drug_exposure dr3 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='1191') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON dr3.drug_concept_id=concept_id) GROUP BY person_id) c ON b.person_id=c.person_id) WHERE (ABS(DATEDIFF(day, b.min_start_date, a.min_start_date)) + ABS(DATEDIFF(day, c.min_start_date, b.min_start_date)) < 365 OR  ABS(DATEDIFF(day, c.min_start_date, a.min_start_date)) + ABS(DATEDIFF(day, b.min_start_date, c.min_start_date)) < 365 OR  ABS(DATEDIFF(day, a.min_start_date, b.min_start_date)) + ABS(DATEDIFF(day, c.min_start_date, a.min_start_date)) < 365 );"
    },
    {
        "question": "counts of patients with taking drug <ARG-DRUG><0> grouped by year of prescription.",
        "query": "SELECT DATE_PART_YEAR(drug_exposure_start_date), COUNT( DISTINCT dr1.person_id) FROM (<SCHEMA>.drug_exposure dr1 JOIN <DRUG-TEMPLATE><ARG-DRUG><0> ON dr1.drug_concept_id=concept_id) GROUP BY DATE_PART_YEAR(drug_exposure_start_date);",
        "final_query_example": "SELECT drug_exposure_start_date, COUNT( DISTINCT dr1.person_id) FROM (cmsdesynpuf23m.drug_exposure dr1 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='36567') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON dr1.drug_concept_id=concept_id) GROUP BY drug_exposure_start_date;"
    },
    {
        "question": "How many people have treated by drug <ARG-DRUG><0> followed by drug <ARG-DRUG><1>?",
        "query": "SELECT COUNT( DISTINCT dr1.person_id ) FROM (<SCHEMA>.drug_exposure dr1 JOIN <DRUG-TEMPLATE><ARG-DRUG><0> ON dr1.drug_concept_id=concept_id) JOIN (<SCHEMA>.drug_exposure dr2 JOIN <DRUG-TEMPLATE><ARG-DRUG><1> ON dr2.drug_concept_id=concept_id) ON dr1.person_id = dr2.person_id AND DATEDIFF(day, dr2.drug_exposure_start_date, dr1.drug_exposure_start_date) >= 0 ;",
        "final_query_example": "SELECT COUNT( DISTINCT dr1.person_id ) FROM (cmsdesynpuf23m.drug_exposure dr1 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='36567') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON dr1.drug_concept_id=concept_id) JOIN (cmsdesynpuf23m.drug_exposure dr2 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='1191') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON dr2.drug_concept_id=concept_id) ON dr1.person_id = dr2.person_id AND DATEDIFF(day, dr2.drug_exposure_start_date, dr1.drug_exposure_start_date) >= 0 ;"
    },
    {
        "question": "How many people have treated by drug <ARG-DRUG><0> after more than <ARG-TIMEDAYS><0> days of starting with drug <ARG-DRUG><1>?",
        "query": "SELECT COUNT( DISTINCT dr1.person_id ) FROM (<SCHEMA>.drug_exposure dr1 JOIN <DRUG-TEMPLATE><ARG-DRUG><0> ON drug_concept_id=concept_id) JOIN (<SCHEMA>.drug_exposure dr2 JOIN <DRUG-TEMPLATE><ARG-DRUG><1> ON dr2.drug_concept_id=concept_id) ON dr1.person_id = dr2.person_id AND DATEDIFF(day, dr2.drug_exposure_start_date, dr1.drug_exposure_start_date) >= <ARG-TIMEDAYS><0> ;",
        "final_query_example": "SELECT COUNT( DISTINCT dr1.person_id ) FROM (cmsdesynpuf23m.drug_exposure dr1 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='36567') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON drug_concept_id=concept_id) JOIN (cmsdesynpuf23m.drug_exposure dr2 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='1191') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON dr2.drug_concept_id=concept_id) ON dr1.person_id = dr2.person_id AND DATEDIFF(day, dr2.drug_exposure_start_date, dr1.drug_exposure_start_date) >= 365 ;"
    },
    {
        "question": "Counts of patients taking drug <ARG-DRUG><0> and <ARG-DRUG><1> within <ARG-TIMEDAYS><0> days.",
        "query": "SELECT COUNT( DISTINCT a.person_id ) FROM ((SELECT person_id, MIN(drug_exposure_start_date) AS min_start_date FROM (<SCHEMA>.drug_exposure dr1 JOIN <DRUG-TEMPLATE><ARG-DRUG><0> ON dr1.drug_concept_id=concept_id) GROUP BY person_id) a JOIN (SELECT person_id, MIN(drug_exposure_start_date) AS min_start_date FROM (<SCHEMA>.drug_exposure dr2 JOIN <DRUG-TEMPLATE><ARG-DRUG><1> ON dr2.drug_concept_id=concept_id) GROUP BY person_id) b ON a.person_id=b.person_id ) WHERE DATEDIFF(day, GREATEST(a.min_start_date, b.min_start_date), LEAST(a.min_start_date, b.min_start_date)) < <ARG-TIMEDAYS><0>;",
        "final_query_example": "SELECT COUNT( DISTINCT dr1.person_id ) FROM (cmsdesynpuf23m.drug_exposure dr1 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='36567') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON dr1.drug_concept_id=concept_id) JOIN (cmsdesynpuf23m.drug_exposure dr2 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='1191') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON dr2.drug_concept_id=concept_id) ON dr1.person_id = dr2.person_id AND ABS(DATEDIFF(day, dr2.drug_exposure_start_date, dr1.drug_exposure_start_date)) >= 365;"
    },
    {
        "question": "How many people were taking drug <ARG-DRUG><0> in year <ARG-TIMEYEARS><0>.",
        "query": "SELECT COUNT( DISTINCT dr1.person_id) FROM (<SCHEMA>.drug_exposure dr1 JOIN <DRUG-TEMPLATE><ARG-DRUG><0> ON dr1.drug_concept_id=concept_id) WHERE DATE_PART_YEAR(drug_exposure_start_date) <= <ARG-TIMEYEARS><0> and DATE_PART_YEAR(drug_exposure_end_date ) >= <ARG-TIMEYEARS><0>;",
        "final_query_example": "SELECT COUNT( DISTINCT dr1.person_id) FROM (cmsdesynpuf23m.drug_exposure dr1 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='RxNorm' AND concept_code='36567') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON dr1.drug_concept_id=concept_id) WHERE DATE_PART_YEAR(drug_exposure_start_date) < 2009;"
    },
    {
        "question": "counts of patients with condition <ARG-CONDITION><0> grouped by year of diagnosis.",
        "query": "SELECT DATE_PART_YEAR(condition_start_date) AS year, COUNT( DISTINCT con1.person_id ) FROM (<SCHEMA>.condition_occurrence con1 JOIN <CONDITION-TEMPLATE><ARG-CONDITION><0> ON con1.condition_concept_id=concept_id) GROUP BY DATE_PART_YEAR(condition_start_date) ;",
        "final_query_example": "SELECT DATE_PART_YEAR(condition_start_date) AS year, COUNT( DISTINCT con1.person_id ) FROM (cmsdesynpuf23m.condition_occurrence con1 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='S11.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con1.condition_concept_id=concept_id) GROUP BY DATE_PART_YEAR(condition_start_date) ;"
    },
    {
        "question": "How many people have Condition <ARG-CONDITION><0> followed by Condition <ARG-CONDITION><1>?",
        "query": "SELECT COUNT( DISTINCT con1.person_id ) FROM (<SCHEMA>.condition_occurrence con1 JOIN <CONDITION-TEMPLATE><ARG-CONDITION><0> ON con1.condition_concept_id=concept_id) JOIN (<SCHEMA>.condition_occurrence con2 JOIN <CONDITION-TEMPLATE><ARG-CONDITION><1> ON con2.condition_concept_id=concept_id) ON con1.person_id = con2.person_id AND DATEDIFF(day, con2.condition_start_date, con1.condition_start_date) >= 0 ;",
        "final_query_example": "SELECT COUNT( DISTINCT con1.person_id ) FROM (cmsdesynpuf23m.condition_occurrence con1 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='S11.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con1.condition_concept_id=concept_id) JOIN (cmsdesynpuf23m.condition_occurrence con2 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='G47.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con2.condition_concept_id=concept_id) ON con1.person_id = con2.person_id AND DATEDIFF(day, con2.condition_start_date, con1.condition_start_date) >= 0 ;"
    },
    {
        "question": "How many people have Condition <ARG-CONDITION><0> more than <ARG-TIMEDAYS><0> days after diagnosed by Condition <ARG-CONDITION><1>?",
        "query": "SELECT COUNT( DISTINCT con1.person_id ) FROM (<SCHEMA>.condition_occurrence con1 JOIN <CONDITION-TEMPLATE><ARG-CONDITION><0> ON con1.condition_concept_id=concept_id) JOIN (<SCHEMA>.condition_occurrence con2 JOIN <CONDITION-TEMPLATE><ARG-CONDITION><1> ON con2.condition_concept_id=concept_id) ON con1.person_id = con2.person_id AND DATEDIFF(day, con2.condition_start_date, con1.condition_start_date) >= <ARG-TIMEDAYS><0> ;",
        "final_query_example": "SELECT COUNT( DISTINCT con1.person_id ) FROM (cmsdesynpuf23m.condition_occurrence con1 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='S11.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con1.condition_concept_id=concept_id) JOIN (cmsdesynpuf23m.condition_occurrence con2 JOIN ( SELECT descendant_concept_id AS concept_id FROM (SELECT * FROM (SELECT concept_id_2 FROM ( (SELECT concept_id FROM  cmsdesynpuf23m.concept WHERE vocabulary_id='ICD10CM' AND concept_code='G47.0') JOIN  ( SELECT concept_id_1, concept_id_2 FROM  cmsdesynpuf23m.concept_relationship WHERE relationship_id='Maps to' )  ON concept_id=concept_id_1) ) JOIN cmsdesynpuf23m.concept ON concept_id_2=concept_id) JOIN cmsdesynpuf23m.concept_ancestor ON concept_id=ancestor_concept_id )  ON con2.condition_concept_id=concept_id) ON con1.person_id = con2.person_id AND DATEDIFF(day, con2.condition_start_date, con1.condition_start_date) >= 365 ;"
    }
]